<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <title>Flask-SocketIO Test</title>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js" integrity="sha256-yr4fRk/GU1ehYJPAs8P4JlTgu0Hdsp4ZKrx8bDEDC3I=" crossorigin="anonymous"></script>
    <script type="text/javascript" charset="utf-8">
        $(document).ready(function() {
            // Connect to the Socket.IO server.
            // The connection URL has the following format, relative to the current page:
            //     http[s]://<domain>:<port>[/<namespace>]
            //var socket = io("https://hub-brauerei.brauradau.ch/sensor?api_key=uQLm9kttaOR4XDDUTQasq1BV4kPcSuBMwsWd1eMIob4");
            var socket = io("http://localhost:42160/sensor", {
                    query: {
                        api_key: "uQLm9kttaOR4XDasdfDUaTQasq1BV4kPcSuBMwsWd1eMIob4"
                    }
                }
            );

            // Event handler for new connections.
            // The callback function is invoked when a connection with the
            // server is established.
            socket.on('connect', function() {
                console.log("connected")
            });

            let i = 0;
            window.setInterval(function() {
                let data = {
                    "Device": "BrewdiniFridgConUno",
                    "Location": "Brauradau",
                    "Data": {
                        "Temperatur1": 100*Math.random(),
                        "Temperatur2": 100*Math.random(),
                        "Temperatur3": 100*Math.random(),
                    }
                }
                i = i + 1;
                console.log(i)
                socket.emit('new_data', data);
            }, 1000);


            // Handlers for the different forms in the page.
            // These accept data from the user and send it to the server in a
            // variety of way
        });
    </script>
</head>
<body>
    <h1>Flask-SocketIO Test</h1>
    <p>Async mode is: <b>{{ async_mode }}</b></p>
    <p>Average ping/pong latency: <b><span id="ping-pong"></span>ms</b></p>
</body>
</html>
